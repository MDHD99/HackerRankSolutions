I solved this problem in another solution using regex, you can contact me if you want that algorithm.
